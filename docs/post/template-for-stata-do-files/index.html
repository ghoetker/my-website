<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.32.2" />
  <meta name="author" content="Glenn Hoetker">

  
  
  
  
    
      
    
  
  <meta name="description" content="There are many different approaches to writing and documenting the many steps that go into an empirical project. J. Scott Long has a great book, The Workflow of Data Analysis Using Stata, which I strongly recommend. He recommends developing a series of small, highly focused do files, which are run in sequence as needed. I take a different approach, which is keep all of a project&rsquo;s code in one honking large do file, which is divided into sections.">

  
  <link rel="alternate" hreflang="en-us" href="https://ghoetker.github.io/my-website/post/template-for-stata-do-files/">

  


  

  
  
  <meta name="theme-color" content="#EF525B">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="https://ghoetker.github.io/my-website/styles.css">
  

  

  
  <link rel="alternate" href="https://ghoetker.github.io/my-website/index.xml" type="application/rss+xml" title="Glenn Hoetker">
  <link rel="feed" href="https://ghoetker.github.io/my-website/index.xml" type="application/rss+xml" title="Glenn Hoetker">
  

  <link rel="manifest" href="https://ghoetker.github.io/my-website/site.webmanifest">
  <link rel="icon" type="image/png" href="https://ghoetker.github.io/my-website/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="https://ghoetker.github.io/my-website/img/icon-192.png">

  <link rel="canonical" href="https://ghoetker.github.io/my-website/post/template-for-stata-do-files/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Glenn Hoetker">
  <meta property="og:url" content="https://ghoetker.github.io/my-website/post/template-for-stata-do-files/">
  <meta property="og:title" content="A template for Stata .do files | Glenn Hoetker">
  <meta property="og:description" content="There are many different approaches to writing and documenting the many steps that go into an empirical project. J. Scott Long has a great book, The Workflow of Data Analysis Using Stata, which I strongly recommend. He recommends developing a series of small, highly focused do files, which are run in sequence as needed. I take a different approach, which is keep all of a project&rsquo;s code in one honking large do file, which is divided into sections.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2010-09-07T14:11:04-07:00">
  
  <meta property="article:modified_time" content="2010-09-07T14:11:04-07:00">
  

  

  <title>A template for Stata .do files | Glenn Hoetker</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="https://ghoetker.github.io/my-website/">Glenn Hoetker</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="https://ghoetker.github.io/my-website/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="https://ghoetker.github.io/my-website/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="https://ghoetker.github.io/my-website/#posts">
            
            <span>Advice for PhD students</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="https://ghoetker.github.io/my-website/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="https://ghoetker.github.io/my-website/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="https://ghoetker.github.io/my-website/cv/">
            
            <span>CV</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">A template for Stata .do files</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2010-09-07 14:11:04 -0700 MST" itemprop="datePublished dateModified">
      Sep 7, 2010
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Glenn Hoetker">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 min read
  </span>
  

  
  

  
  
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=A%20template%20for%20Stata%20.do%20files&amp;url=https%3a%2f%2fghoetker.github.io%2fmy-website%2fpost%2ftemplate-for-stata-do-files%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fghoetker.github.io%2fmy-website%2fpost%2ftemplate-for-stata-do-files%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fghoetker.github.io%2fmy-website%2fpost%2ftemplate-for-stata-do-files%2f&amp;title=A%20template%20for%20Stata%20.do%20files"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fghoetker.github.io%2fmy-website%2fpost%2ftemplate-for-stata-do-files%2f&amp;title=A%20template%20for%20Stata%20.do%20files"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=A%20template%20for%20Stata%20.do%20files&amp;body=https%3a%2f%2fghoetker.github.io%2fmy-website%2fpost%2ftemplate-for-stata-do-files%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        

<p>There are many different approaches to writing and documenting the many steps that go into an empirical project. J. Scott Long has a great book, <em>The Workflow of Data Analysis Using Stata</em>, which I strongly recommend. He recommends developing a series of small, highly focused do files, which are run in sequence as needed. I take a different approach, which is keep all of a project&rsquo;s code in one honking large do file, which is divided into sections. This posting provides more details about my approach. I&rsquo;ve pasted a skeleton version of this below. To explain what I&rsquo;m trying to do in several places, since this is pretty idiosyncratic.</p>

<h2 id="the-header-section">The HEADER section</h2>

<p>a) gives information on the file (in case I ever find a print-out of it somewhere and need to find it on the computer)</p>

<p>b) lists what files are used and produced by each section. Great when I can&rsquo;t figure out where &ldquo;important_data_file_1&rdquo; comes into play. I could probably do the same just be searching, but I like this way.</p>

<h2 id="the-macros-section">The MACROS section</h2>

<p>a) I use the local macro &ldquo;do_me&rdquo; to control which sections get run for a given run of the do file. The sections are labels a-z and I just insert the letters of the section I want to run into the do_me macro (here, I&rsquo;ll run parts a and b). More below.</p>

<p>b) defines some temp variables, files, etc., just for future reference.</p>

<h2 id="the-main-code-block">The MAIN CODE block</h2>

<p>a) Since I like to run my code and then examine the aftermath, I turn more off</p>

<p>b) The line</p>

<pre><code>if strpos(&quot;`do_me'&quot;,&quot;a&quot;)&gt;0 {
</code></pre>

<p>evaluates to some number greater than 0 if I included &ldquo;a&rdquo; in my definition of _do<em>me</em>. In that case, everything with the brackets defining section &ldquo;a&rdquo; will be run. If &ldquo;a&rdquo; isn&rsquo;t in _do<em>me</em>, this evaluates to 0 and nothing between the brackets is run. And so on and so forth. This way I can go to one point of the do file (the Macros section), see what each section does and flip them on or off for a given run.</p>

<p>Typically, section A is all about taking raw data and manipulating it into the data I&rsquo;ll use and then saving that for use by subsequent sessions. With any luck, I only have to run this section once. Section B is probably descriptive statistics, C-?? will be different modeling strategies. Then there will be a section for producing publication-ready output.</p>

<p>The pluses I&rsquo;ve found to this system are that everything is captured in one place, easy to reference, edit and run. I don&rsquo;t have to comment sections in and out to control what runs. There are minuses. Because the file is so long, typically, one has to watch it all scroll by on the screen. When editing, getting from one section to another can be a pain. I&rsquo;ve solved this by always using text editors that allow for tags or bookmarks. I assign the tag &ldquo;0&rdquo; to the line &ldquo;_local do<em>me&hellip;</em>&rdquo;; the tag &ldquo;A&rdquo; to the starting line of section a, etc. Puts any part of the code within a few keystrokes.</p>

<p>As I’ve re-read Long’s book several times, I’m seeing benefits to his approach. I’m not sure if I’ll actually switch, but I’m tempted to experiment.</p>

<div class="alert alert-note">
  <p>As of January, 2018, I&rsquo;ve slightly modified my approach from what is described here. One of these days, I&rsquo;ll make an updated post. I think the logic of this approach, however, is still valid.</p>

</div>


<h2 id="an-example-file">An example file</h2>

<pre><code>/*

FILE NAME:

DESC:

A:

Input files

Output files

B:

Input files

Output files

*/

/*MACROS*/

local do_me &quot;ab&quot; /*Which sections to do */
// a. Description of what part &quot;a&quot; does
// b. Description of what part &quot;b&quot; does
// c.
// d.

local base
local base
tempvar tv1
tempvar tv2
tempfile tf1


/*BEGIN MAIN CODE BLOCK*/

set more off

/* A. Description */
if strpos(&quot;`do_me'&quot;,&quot;a&quot;)&gt;0 {
set memory 250m
clear
cd `base'

[Insert code here...]
save working_data, replace
}

/* B. Description */
if strpos(&quot;`do_me'&quot;,&quot;b&quot;)&gt;0 {
set memory 250m
clear
cd `base'

use working_data
[code here]
}
</code></pre>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="https://ghoetker.github.io/my-website/tags/stata">Stata</a>
  
  <a class="btn btn-primary btn-outline" href="https://ghoetker.github.io/my-website/tags/statistical-packages">Statistical packages</a>
  
  <a class="btn btn-primary btn-outline" href="https://ghoetker.github.io/my-website/tags/software">Software</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="https://ghoetker.github.io/my-website/post/excel-is-evil/">Excel Is evil</a></li>
    
    <li><a href="https://ghoetker.github.io/my-website/post/what-statistical-package/">What statistical package should I use?</a></li>
    
  </ul>
</div>




<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    <script async defer src="//maps.googleapis.com/maps/api/js?key=AIzaSyCzPQwS-SUJ27Uo5UvF0to4WxUu1QxDAVE"></script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
    
    
    <script src="https://ghoetker.github.io/my-website/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

